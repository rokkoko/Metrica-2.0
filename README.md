# README

Приложение для учета статистики активностей пользователя: количество очков, игры, участники, друзья.

Приложение имеет интерфейс телеграм-бота (`a-ww-bot` - название бота для подключения в чате), который является точкой 
входа для регистрации пользователя и метрики в системе, запись в БД результатов активности, подписка на сервисы 
приложения (регулярные статистические уведомления).

Отдельно, (на уровне тестирования) реализована функциональность по проверке правописания "на лету".

Также приложение имеет web-интерфейс (html). Рэндер Django на бэкэнде. Реализованы (в качестве получения опыта) 
следующие технологии:
1. Websockets - уведомление пользователя о добавлении его в список друзей и поступлении запроса на добавление в друзья;
2. Redis - кэширование сайта и в качестве брокера и хранилища результатов для Celery
3. Celery - рассылка статистики по метрике в группу Телеграм по предварительным данным, собранным от пользователя 
   телеграм-ботом;
4. Mailgun - почтовый сервер для рассылки почты пользователям (уведомления о добавлении в друзья, уведомления об 
   ухудшении недельной игровой статистики);
5. Rollbar - трэккинг ошибок приложения;
6. Logging - встроенная Python-библиотека

Ознакомление (без реализации в проекте) с:
1. JWT - аутентификация в Django;
2. Docker - деплой приложения в контейнере;
3. Allauth - аутентификация через Gmail.

## Деплой и инфраструктура

Сервер и база данных на Хероку, приложение `a-metrica`, https://a-metrica.herokuapp.com/.
Данные для подключения локально в `.env` файле, на сервере в переменных окружения проекта. Деплой 
вручную, пушим в ремоут `heroku`. Менеджер пакетов - `Poetry`, для генерации файлов зависимостей для Хероку используется
билдпак (установлен в Хероку). Статика раздается с помощью `whitenoise`, media - AWS S3, подключенный к Heroku.

## Цели

- получить опыт работы с проектом от идеи до реализации (работа с Git, Github, PyCharm, Poetry, Deploy, оформление
  кода);
- получить опыт работы со стеком Django;
- получить опыт работы с базой данных и реальными запросами в понятном контексте (джоины, проектирование таблиц, 
  оптимизация запросов, Django ORM);
- получить проект в портфолио как подтверждение навыков работы;
- сделать платформу для проб новых подходов и решений.

## Стек и архитектура

- Собственный телеграм-бот для интеграции с Telegram: реакции на команды (`/add` и т.п.) и реквест на сервер Django, 
  и второй - реакция на входящий реквест `process_update` (вебхук) и отсылка сообщения в Telegram;
- Приложения Django 'games' (вся логика работы с метриками), 'telegram_bot' (работа с чатами, в которых присутствует 
  бот, ORM для сбора статистической информации), 'users' (аутентификация, регистрация, 'друзья', обслуживание статики
  юзеров (аватарки при регистрации));
- Django signals для работы сервиса отправки писем пользователям по факту инициализации процесса добавления в друзья;
- Хероку для базы данных (Postgres);
- Интеграция с Github, Rollbar, Mailgun;
- Реализация 'приватных' игровых сессий, доступ к которым и статистику по которым имеет только пользователь. 
  ORM с учетом данного функционала;
- Реализация сбора ботом статистики по анимированным сообщениям отправленным участниками группы с записью ее в БД в
  отдельной метрике для анализа их использования вместо слов (достигнуто в ущерб безопасности переписки, т.к. бот должен
  иметь доступ ко всей переписке);
- Реализация проверки ботом правописания ВСЕХ сообщений в группе (чате) "на лету" (достигнуто в ущерб безопасности 
  переписки, т.к. бот должен иметь доступ ко всей переписке)